open import ToddPrelude
open import CantorNumbers
open import RealNumbers
open import Searchers
open import Lossers

Î³ : (X Y : Set) â†’ Set
Î³ X Y = â„Ì‚ â†’ Y â†’ (X â†’ Y) â†’ X

buildReg : {X Y : Set} (â„° : (X â†’ ğ”¹) â†’ X) â†’ (Î¦ : Y â†’ Y â†’ â„) â†’ Î³ X Y
buildReg â„° Î¦ = Î» Îµ y m â†’ â„° (Î» x â†’ (Î¦ (m x) y <â„ Îµ))

Î³â„•,â„• : â„• â†’ Î³ â„• â„•
Î³â„•,â„• n = buildReg (â„°â„• n) Î¦â„•

Î³â„•Ã—â„•,â„• : â„• â†’ Î³ (â„• Ã— â„•) â„•
Î³â„•Ã—â„•,â„• n = buildReg (â„°Ã— (â„°â„• n) (â„°â„• n)) Î¦â„•

Î³â„•Ã—â„•,â„•â†’â„• : â„• â†’ Î³ (â„• Ã— â„•) (â„• â†’ â„•)
Î³â„•Ã—â„•,â„•â†’â„• n = buildReg (â„°Ã— (â„°â„• n) (â„°â„• n)) (Î¦â„•â†’â„• n)

Î³â„‚,â„‚â†’â„‚ : â„• â†’ Î³ â„‚ (â„‚ â†’ â„‚)
Î³â„‚,â„‚â†’â„‚ n = buildReg â„°â„‚ (Î¦â„‚â†’â„‚ n)

test1a : â„•
test1a = Î³â„•,â„• 1000 (â„â‚ , 5) 28 (Î» x â†’ x +â„• 3)

test1b : â„•
test1b = Î³â„•,â„• 1000 ((3 , â„‚â‚€) , 5) 28 (Î» x â†’ x +â„• 3)

test1c : â„•
test1c = Î³â„•,â„• 10000 (â„â‚ , 5) 128 (Î» x â†’ x *â„• 9) 

test2a : â„• Ã— â„•
test2a = Î³â„•Ã—â„•,â„• 200 (â„â‚ , 0) 8 (Î» x â†’ (Ï€â‚ x))

test2b : â„• Ã— â„•
test2b = Î³â„•Ã—â„•,â„• 50 (â„â‚ , 0) 8 (Î» x â†’ Ï€â‚ x +â„• Ï€â‚‚ x) 

test2c : â„• Ã— â„•
test2c = Î³â„•Ã—â„•,â„•â†’â„• 20 (â„â‚ , 0) (Î» x â†’ (7 *â„• x) +â„• 7) (Î» m x â†’ (Ï€â‚‚ m *â„• x) +â„• Ï€â‚‚ m)

test2d : â„• Ã— â„•
test2d = Î³â„•Ã—â„•,â„•â†’â„• 5 (â„â‚ , 0) (Î» x â†’ (3 *â„• x) +â„• 4) (Î» m x â†’ (Ï€â‚ m *â„• x) +â„• Ï€â‚‚ m)
